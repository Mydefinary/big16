server:
  port: 9000
  address: 0.0.0.0

---
spring:
  profiles: default
  cloud:
    gateway:
      routes:
        # ... ê¸°ì¡´ ë¼ìš°íŠ¸ë“¤ ...
        
        # ğŸ†• ì›¹íˆ° ëŒ€ì‹œë³´ë“œ í”„ë¡ íŠ¸ì—”ë“œ ì¶”ê°€
        - id: webtoon-frontend
          uri: http://localhost:8080
          predicates:
            - Path=/webtoon/**

        # ğŸ†• ì›¹íˆ° í•˜ì´ë¼ì´íŠ¸ ì œì‘ ì„œë¹„ìŠ¤ ì¶”ê°€ (localhost í™˜ê²½)
        - id: webtoon-hl-backend
          uri: http://localhost:8003
          predicates:
            - Path=/api/webtoon-hl/**
          filters:
            - name: JwtAuthenticationFilter

        - id: webtoon-hl-frontend
          uri: http://localhost:3003
          predicates:
            - Path=/webtoon-hl/**

        # ğŸ†• PPL ìƒì„±ê¸° ì„œë¹„ìŠ¤ ì¶”ê°€ (localhost í™˜ê²½)
        - id: ppl-gen-backend
          uri: http://localhost:8000
          predicates:
            - Path=/api/ppl-gen/**
          filters:
            - name: JwtAuthenticationFilter

        - id: ppl-gen-frontend
          uri: http://localhost:3000  # ë˜ëŠ” ë‹¤ë¥¸ í¬íŠ¸
          predicates:
            - Path=/ppl-gen/**

        # ğŸ†• êµ¿ì¦ˆ ìƒì„±ê¸° ì„œë¹„ìŠ¤ ì¶”ê°€ (localhost í™˜ê²½)
        - id: goods-gen-backend
          uri: http://localhost:8001
          predicates:
            - Path=/api/goods-gen/**
          filters:
            - name: JwtAuthenticationFilter

        - id: goods-gen-frontend
          uri: http://localhost:3001  # í¬íŠ¸ ì¶©ëŒ ë°©ì§€ë¥¼ ìœ„í•´ ë³€ê²½
          predicates:
            - Path=/goods-gen/**

        # ğŸ†• ì±—ë´‡(ì§ˆë¬¸) ì„œë¹„ìŠ¤ ì¶”ê°€ (localhost í™˜ê²½)
        - id: question-backend
          uri: http://localhost:8083
          predicates:
            - Path=/question-api/**
          filters:
            - name: JwtAuthenticationFilter

        - id: question-frontend
          uri: http://localhost:3083  # localhost í™˜ê²½ìš© í¬íŠ¸
          predicates:
            - Path=/question/**
            
        # ğŸ¯ í”„ë¡ íŠ¸ì—”ë“œ ë¼ìš°íŠ¸ëŠ” ê°€ì¥ ë§ˆì§€ë§‰
        - id: frontend
          uri: http://localhost:9003
          predicates:
            - Path=/**
      
      globalcors:
        cors-configurations:  # ğŸ”§ ì˜¤íƒ€ ìˆ˜ì •: corsConfigurations -> cors-configurations
          '[/**]':
            allowed-origins:  # ğŸ”§ camelCase -> kebab-case
              - "*"    # ëª¨ë“  origins í—ˆìš©
            allowed-methods:
              - "GET"
              - "POST" 
              - "PUT"
              - "DELETE"
              - "PATCH"
              - "OPTIONS"
            allowed-headers:
              - "*"
            allow-credentials: true  # ğŸ”§ camelCase -> kebab-case
            max-age: 3600  # ğŸ¯ CORS preflight ìºì‹œ ì‹œê°„

---
spring:
  profiles: docker
  cloud:
    gateway:
      routes:
        # ğŸ¯ Docker í™˜ê²½ì—ì„œë„ public/private ê²½ë¡œ ë¶„ë¦¬
        - id: auth-public
          uri: http://auth-backend-lee-service:9001
          predicates:
            - Path=/auths/login,/auths/refresh,/auths/verify-code,/auths/reset-password,/auths/resend-code
            
        - id: auth-private
          uri: http://auth-backend-lee-service:9001
          predicates:
            - Path=/auths/**
          filters:
            - name: JwtAuthenticationFilter
            
        - id: user-public
          uri: http://user-backend-lee-service:9002
          predicates:
            - Path=/users/register,/users/check-email,/users/find-id
            
        - id: user-private
          uri: http://user-backend-lee-service:9002
          predicates:
            - Path=/users/**
          filters:
            - name: JwtAuthenticationFilter
            
        # ğŸ†• ì›¹íˆ° ëŒ€ì‹œë³´ë“œ ë¼ìš°íŠ¸ ì¶”ê°€ (Docker í™˜ê²½)
        - id: webtoon-backend
          uri: http://webtoon-dashboard-backend-service:8002
          predicates:
            - Path=/webtoon-api/**
          # JWT í•„í„° í•„ìš”ì‹œ ì¶”ê°€:
          filters:
            - name: JwtAuthenticationFilter
            
        - id: webtoon-frontend  
          uri: http://webtoon-dashboard-frontend-service:80
          predicates:
            - Path=/webtoon/**
          # ì •ì  íŒŒì¼ì´ë¯€ë¡œ JWT í•„í„° ì—†ìŒ

        # ğŸ†• ì›¹íˆ° í•˜ì´ë¼ì´íŠ¸ ì œì‘ ì„œë¹„ìŠ¤ ì¶”ê°€ (Docker í™˜ê²½)
        - id: webtoon-hl-backend
          uri: http://webtoon-hl-backend-service-lee-2:8003  # ì„œë¹„ìŠ¤ í¬íŠ¸ì™€ ë§¤ì¹­
          predicates:
            - Path=/api/highlight/**
          # JWT í•„í„° í•„ìš”ì‹œ ì¶”ê°€:
          filters:
            - name: JwtAuthenticationFilter

        - id: webtoon-hl-frontend
          uri: http://webtoon-hl-frontend-service-lee-2:80  # ì„œë¹„ìŠ¤ í¬íŠ¸ì™€ ë§¤ì¹­
          predicates:
            - Path=/webtoon-hl/**
          # ì •ì  íŒŒì¼ì´ë¯€ë¡œ JWT í•„í„° ì—†ìŒ

        # ğŸ†• PPL ìƒì„±ê¸° ì„œë¹„ìŠ¤ ì¶”ê°€
        - id: ppl-gen-backend
          uri: http://ppl-gen-backend-service-lee-2:8000  # docker í™˜ê²½
          predicates:
            - Path=/api/ppl-gen/**
          # JWT í•„í„° í•„ìš”ì‹œ ì¶”ê°€:
          filters:
            - name: JwtAuthenticationFilter

        - id: ppl-gen-frontend
          uri: http://ppl-gen-frontend-service-lee-2:80
          predicates:
            - Path=/ppl-gen/**
          # ì •ì  íŒŒì¼ì´ë¯€ë¡œ JWT í•„í„° ì—†ìŒ

        # ğŸ†• êµ¿ì¦ˆ ìƒì„±ê¸° ì„œë¹„ìŠ¤ ì¶”ê°€  
        - id: goods-gen-backend
          uri: http://goods-gen-backend-service-lee-2:8001  # docker í™˜ê²½
          predicates:
            - Path=/api/goods-gen/**
          # JWT í•„í„° í•„ìš”ì‹œ ì¶”ê°€:
          filters:
            - name: JwtAuthenticationFilter

        - id: goods-gen-frontend
          uri: http://goods-gen-frontend-service-lee-2:80
          predicates:
            - Path=/goods-gen/**
          # ì •ì  íŒŒì¼ì´ë¯€ë¡œ JWT í•„í„° ì—†ìŒ

        # ğŸ†• ì±—ë´‡(ì§ˆë¬¸) ì„œë¹„ìŠ¤ ì¶”ê°€ (Docker/Kubernetes í™˜ê²½)        
        - id: question-backend
          uri: http://question-backend-service-lee-2:8083  # -lee-2 ì¶”ê°€
          predicates:
            - Path=/question-api/**
      
        - id: question-frontend
          uri: http://question-frontend-service-lee-2:80   # -lee-2 ì¶”ê°€
          predicates:
            - Path=/question/**

          # ğŸ†• ê²Œì‹œíŒ ì„œë¹„ìŠ¤ ì¶”ê°€ (Docker/Kubernetes í™˜ê²½)
        - id: board-backend
          uri: http://board-backend-service-lee:8082
          predicates:
            - Path=/board/api/**
          filters:
            - name: JwtAuthenticationFilter

        - id: board-frontend
          uri: http://board-frontend-service-lee:80
          predicates:
            - Path=/board/**
          # ì •ì  íŒŒì¼ì´ë¯€ë¡œ JWT í•„í„° ì—†ìŒ
            
        - id: frontend
          uri: http://frontend-lee-service:9003
          predicates:
            - Path=/**
          # Docker í™˜ê²½ì—ì„œë„ ì •ì  íŒŒì¼ì—ëŠ” JWT í•„í„° ì—†ìŒ
          
      globalcors:
        cors-configurations:
          '[/**]':
            allowed-origins:
              - "http://20.249.113.18:9000"        # ì™¸ë¶€ LB
              - "https://20.249.113.18:9000"        # ì™¸ë¶€ LB
            allowed-methods:
              - "GET"
              - "POST"
              - "PUT" 
              - "DELETE"
              - "PATCH"
              - "OPTIONS"
            allowed-headers:
              - "*"
            allow-credentials: true
            max-age: 3600