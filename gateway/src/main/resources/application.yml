server:
  port: 8088

---
spring:
  profiles: default
  cloud:
    gateway: #<<< API Gateway / Routes
      routes:
        - id: auth-public
          uri: http://localhost:8082
          predicates:
            - Path=/auths/login,/auths/refresh,/auths/verify-code,/auths/reset-password,/auths/resend-code
          # í•„í„° ì—†ìŒ (ì¸ì¦ ë¶ˆí•„ìš”)
          
        - id: auth-private
          uri: http://localhost:8082
          predicates:
            - Path=/auths/**
          filters:
            - name: JwtAuthenticationFilter
            
        - id: user-public
          uri: http://localhost:8083
          predicates:
            - Path=/users/register,/users/check-email,/users/find-id
          # í•„í„° ì—†ìŒ
          
        - id: user-private
          uri: http://localhost:8083
          predicates:
            - Path=/users/**
          filters:
            - name: JwtAuthenticationFilter
            
        # ğŸ¯ í”„ë¡ íŠ¸ì—”ë“œ ë¼ìš°íŠ¸ëŠ” JWT í•„í„° ì œê±° (ì •ì  íŒŒì¼ì´ë¯€ë¡œ)
        - id: frontend
          uri: http://localhost:8080
          predicates:
            - Path=/**
          # í•„í„° ì œê±°! ì •ì  íŒŒì¼ì—ëŠ” JWT ê²€ì¦ì´ ë¶ˆí•„ìš”
      #>>> API Gateway / Routes
      
      globalcors:
        cors-configurations:  # ğŸ”§ ì˜¤íƒ€ ìˆ˜ì •: corsConfigurations -> cors-configurations
          '[/**]':
            allowed-origins:  # ğŸ”§ camelCase -> kebab-case
              - "*"    # Vite ê°œë°œì„œë²„ (ì»¤ìŠ¤í…€ í¬íŠ¸)
            allowed-methods:
              - "GET"
              - "POST" 
              - "PUT"
              - "DELETE"
              - "PATCH"
              - "OPTIONS"
            allowed-headers:
              - "*"
            allow-credentials: true  # ğŸ”§ camelCase -> kebab-case
            max-age: 3600  # ğŸ¯ CORS preflight ìºì‹œ ì‹œê°„

---
spring:
  profiles: docker
  cloud:
    gateway:
      routes:
        # ğŸ¯ Docker í™˜ê²½ì—ì„œë„ public/private ê²½ë¡œ ë¶„ë¦¬
        - id: auth-public
          uri: http://auth:8080
          predicates:
            - Path=/auths/login,/auths/refresh,/auths/verify-code,/auths/reset-password,/auths/resend-code
            
        - id: auth-private
          uri: http://auth:8080
          predicates:
            - Path=/auths/**
          filters:
            - name: JwtAuthenticationFilter
            
        - id: user-public
          uri: http://user:8080
          predicates:
            - Path=/users/register,/users/check-email,/users/find-id
            
        - id: user-private
          uri: http://user:8080
          predicates:
            - Path=/users/**
          filters:
            - name: JwtAuthenticationFilter
            
        - id: frontend
          uri: http://frontend:8080
          predicates:
            - Path=/**
          # Docker í™˜ê²½ì—ì„œë„ ì •ì  íŒŒì¼ì—ëŠ” JWT í•„í„° ì—†ìŒ
          
      globalcors:
        cors-configurations:
          '[/**]':
            allowed-origins:
              - "http://localhost:8088"  # Gateway í¬íŠ¸
              - "http://frontend:8080"   # Docker ë‚´ë¶€ í†µì‹ 
            allowed-methods:
              - "GET"
              - "POST"
              - "PUT" 
              - "DELETE"
              - "PATCH"
              - "OPTIONS"
            allowed-headers:
              - "*"
            allow-credentials: true
            max-age: 3600

server:
  port: 8080