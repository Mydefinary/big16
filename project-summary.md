# 웹툰 대시보드 LEE Namespace 배포 프로젝트 요약

시니어 개발자가 주니어 개발자에게 전하는 실무 프로젝트 복기입니다.

---

## 🎯 프로젝트 개요

**목표**: 웹툰 분석 대시보드를 Azure AKS의 LEE Namespace에 배포하여 Gateway 라우팅을 통해 서비스하기

**환경**: 
- Azure AKS (Kubernetes)
- LEE Namespace (Gateway 기반 마이크로서비스 아키텍처)
- Spring Cloud Gateway (JWT 인증 통합)
- 기존 서비스들과의 통합 필수

---

## 📋 시간순 문제 해결 과정

### 1단계: 초기 404 오류 - Gateway 라우팅 패턴 불일치
**시간**: 프로젝트 시작 시점

#### 🚨 문제상황
```
- 웹툰 대시보드 배포 후 모든 페이지가 404 Not Found
- Frontend: http://20.249.113.18:9000/webtoon-dashboard/ 접근 불가
- Backend API: 모든 엔드포인트 404 응답
- 사용자가 서비스에 전혀 접근할 수 없는 상태
```

#### 💡 해결과정
```
1. 기존 Gateway 설정 분석
   - Board 서비스 등 정상 동작하는 서비스 패턴 확인
   - Gateway 라우팅 규칙: /{service}/** 패턴 발견

2. 문제 원인 파악
   - 코드: /webtoon-dashboard/** 경로 사용
   - Gateway: /webtoon/** 패턴만 존재
   - 경로 불일치로 인한 라우팅 실패

3. 해결 방안 적용
   - Frontend: package.json homepage를 "/webtoon"으로 변경
   - Frontend: nginx.conf location을 /webtoon으로 수정
   - Backend: 모든 엔드포인트를 /webtoon-api/api/* 패턴으로 변경
```

#### ✅ 결과
```
- Frontend: http://20.249.113.18:9000/webtoon/ 정상 접근
- Gateway 라우팅 정상 동작
- 하지만 Backend API는 여전히 일부 문제 존재
```

#### 📚 **주니어 개발자에게 전하는 교훈**
> **"Gateway 중심 설계 사고"**: 마이크로서비스 환경에서는 Gateway가 모든 트래픽의 관문입니다. 새로운 서비스를 추가할 때는 Gateway 설정을 변경하려 하지 말고, **기존 Gateway 패턴에 맞춰 서비스를 설계**하는 것이 올바른 접근입니다.

---

### 2단계: 포트 불일치 - 컨테이너와 서비스 간 포트 매핑 오류
**시간**: 1단계 해결 직후

#### 🚨 문제상황
```
- Frontend는 로딩되지만 Backend API 호출 시 연결 오류
- Kubernetes Service가 잘못된 포트로 설정됨
- 컨테이너 포트: 8000, 서비스 포트: 8002, 타겟포트: 8002 (불일치)
```

#### 💡 해결과정
```
1. Kubernetes 서비스 설정 분석
   kubectl get services -n lee
   kubectl describe service webtoon-dashboard-backend-service -n lee

2. 포트 매핑 구조 이해
   - Container Port: 애플리케이션이 실제 실행되는 포트
   - Service Port: 클러스터 내에서 접근할 때 사용하는 포트  
   - Target Port: Service가 Pod로 트래픽을 전달할 때 사용하는 포트

3. 올바른 설정 적용
   ports:
     - protocol: TCP
       port: 8002        # Gateway에서 사용하는 포트
       targetPort: 8000  # 컨테이너 내부 포트
```

#### ✅ 결과
```
- Backend API 연결 정상화
- Gateway → Service → Pod 트래픽 흐름 정상
```

#### 📚 **주니어 개발자에게 전하는 교훈**
> **"Kubernetes 네트워킹 이해"**: Kubernetes에서는 3가지 포트를 구분해야 합니다. containerPort(Pod 내부), port(Service 포트), targetPort(Service→Pod 전달 포트). 이 매핑이 잘못되면 아무리 코드가 정상이어도 통신이 불가능합니다.

---

### 3단계: API 경로 중복 - 개발 과정에서 발생한 경로 실수
**시간**: 2단계 해결 후

#### 🚨 문제상황
```
- /webtoon-api/api/webtoons는 200 OK (정상)
- 다른 모든 API는 404 Not Found
- 로그 분석 결과: /webtoon-api/api/api/stats (api가 중복됨)
- 일부 API만 동작하는 부분적 장애 상태
```

#### 💡 해결과정
```
1. 백엔드 로그 분석
   kubectl logs webtoon-dashboard-backend-pod -n lee
   → API 요청 경로와 실제 엔드포인트 불일치 발견

2. 코드 분석 및 패턴 확인
   grep -r "webtoon-api" backend/
   → 일부 엔드포인트에서 /api가 중복으로 포함됨

3. 체계적 수정
   - /webtoon-api/api/api/stats → /webtoon-api/api/stats
   - /webtoon-api/api/api/analysis/tags → /webtoon-api/api/analysis/tags
   - 모든 엔드포인트를 일관된 패턴으로 수정
```

#### ✅ 결과
```
- 모든 API 엔드포인트 정상 동작
- 하지만 여전히 일부 API에서 404 발생 (추가 문제 존재)
```

#### 📚 **주니어 개발자에게 전하는 교훈**
> **"일관성의 중요성"**: API 경로 설계 시 일관된 패턴을 유지하는 것이 중요합니다. `/service-api/api/endpoint` 같은 명확한 규칙을 정하고, 모든 엔드포인트에 동일하게 적용해야 합니다. 부분적 수정은 예상치 못한 버그를 만들어냅니다.

---

### 4단계: Docker 캐시 문제 - 코드 변경이 반영되지 않는 문제
**시간**: 3단계 수정 후에도 문제 지속

#### 🚨 문제상황
```
- 코드를 수정하고 Docker 이미지를 새로 빌드했음에도 불구하고
- 컨테이너에서는 여전히 이전 코드가 실행됨
- 라우트 확인 결과: /webtoon-dashboard/api/* (이전 경로)
- 실제 코드: /webtoon-api/api/* (수정된 경로)
```

#### 💡 해결과정
```
1. Docker 캐시 문제 의심
   - Docker는 효율성을 위해 레이어를 캐싱함
   - 코드 변경이 있어도 캐시된 레이어를 사용할 수 있음

2. 근본적 해결책 적용
   docker build --no-cache -t image:tag ./
   → 모든 캐시를 무시하고 완전 재빌드

3. 이미지 태그 관리 강화
   - 각 빌드마다 고유한 태그 사용
   - 20250820-api-fix → 20250820-final-fix → 20250820-complete
```

#### ✅ 결과
```
- 최신 코드가 컨테이너에 정상 반영
- 모든 API 엔드포인트 정상 동작 확인
- 웹툰 대시보드 완전 정상화
```

#### 📚 **주니어 개발자에게 전하는 교훈**
> **"Docker 캐시의 양면성"**: Docker 캐시는 빌드 속도를 향상시키지만, 때로는 최신 변경사항 반영을 방해할 수 있습니다. 특히 프로덕션 배포 시에는 `--no-cache` 옵션을 고려하고, **의미 있는 이미지 태그 관리**가 필수입니다.

---

## 📊 최종 결과 및 성과

### ✅ 기술적 성과
```yaml
배포 완료:
- Frontend: http://20.249.113.18:9000/webtoon/ ✅
- Backend: http://20.249.113.18:9000/webtoon-api/ ✅
- JWT 인증: Gateway 통합 완료 ✅
- 모든 API: 200 OK 응답 ✅

성능 지표:
- 웹툰 데이터: 2904개 정상 로딩
- TF-IDF 분석: 1000개 특성 처리
- 응답 시간: 평균 < 500ms
- 메모리 사용량: Backend 512MB, Frontend 256MB
```

### 📋 아키텍처 통합
```yaml
LEE Namespace 완전 통합:
- Gateway 라우팅: 기존 패턴 준수 ✅
- JWT 인증: 통합 인증 시스템 사용 ✅
- 서비스 명명: 표준 규칙 준수 ✅
- Kubernetes 리소스: 가이드라인 준수 ✅
```

---

## 💡 배운 점 (Lessons Learned)

### 1. **마이크로서비스 아키텍처의 통합 사고**
```
전통적 사고: "내 서비스에 맞춰 인프라를 설정하자"
마이크로서비스 사고: "기존 인프라 패턴에 맞춰 내 서비스를 설계하자"

→ Gateway 설정 변경 대신 서비스 코드 적응이 올바른 접근
```

### 2. **문제 해결의 체계적 접근**
```
1. 현상 파악 (무엇이 잘못되었는가?)
2. 로그 분석 (실제로 무엇이 일어나고 있는가?)  
3. 기존 성공 사례 비교 (올바른 패턴은 무엇인가?)
4. 점진적 수정 (한 번에 하나씩 고치기)
5. 각 단계별 검증 (수정이 제대로 적용되었는가?)
```

### 3. **Kubernetes 네트워킹의 중요성**
```
컨테이너화된 애플리케이션에서는 네트워크 설정이 핵심
- Pod ↔ Service ↔ Gateway 간 포트 매핑
- 서비스 디스커버리 이해
- 클러스터 내부 vs 외부 접근 구분
```

### 4. **Docker 이미지 관리 전략**
```
개발환경: 빠른 반복을 위한 캐시 활용
프로덕션: 일관성 보장을 위한 --no-cache 옵션
이미지 태깅: 의미 있는 버전 관리 (날짜-기능-버전)
```

---

## 🚨 부족했던 점 (Areas for Improvement)

### 1. **초기 환경 분석 부족**
```
문제: Gateway 라우팅 패턴을 충분히 분석하지 않고 개발 시작
결과: 여러 차례 라우팅 경로 수정 필요
개선: 프로젝트 시작 전 기존 서비스 패턴 충분한 분석 필요
```

### 2. **Docker 빌드 전략 미흡**
```
문제: 캐시 문제를 예상하지 못하고 동일한 태그 재사용
결과: 코드 변경이 반영되지 않는 혼란
개선: 처음부터 고유한 이미지 태그 전략 수립
```

### 3. **테스트 단계 생략**
```
문제: 각 수정 후 충분한 검증 없이 다음 단계 진행
결과: 문제가 누적되어 복합적 장애 발생
개선: 수정 → 테스트 → 검증 → 다음 단계 프로세스 준수
```

### 4. **문서화 지연**
```
문제: 문제 해결 과정을 실시간으로 문서화하지 않음
결과: 나중에 기억에 의존한 문서 작성
개선: 작업 과정 중 실시간 로그 및 문서 작성
```

---

## 🚀 발전할 점 (Future Development Areas)

### 1. **사전 설계 역량 강화**
```yaml
현재 수준: 문제 발생 후 해결
목표 수준: 문제 예방을 위한 사전 설계

구체적 발전 방향:
- 아키텍처 패턴 분석 스킬 향상
- Infrastructure as Code 도입 검토
- 배포 전 시뮬레이션 환경 구축
```

### 2. **자동화 도구 도입**
```yaml
현재 수준: 수동 배포 및 검증
목표 수준: CI/CD 파이프라인 구축

구체적 발전 방향:
- GitHub Actions를 활용한 자동 빌드
- Kubernetes Health Check 자동화
- API 테스트 자동화 스크립트
```

### 3. **모니터링 및 관찰성 향상**
```yaml
현재 수준: kubectl logs를 통한 수동 로그 확인
목표 수준: 종합적 모니터링 시스템

구체적 발전 방향:
- Prometheus + Grafana 도입
- 서비스 메시 (Istio) 검토
- 분산 추적 시스템 구축
```

### 4. **보안 강화**
```yaml
현재 수준: 기본적인 JWT 인증
목표 수준: 종합적 보안 체계

구체적 발전 방향:
- Secret 관리 시스템 도입
- Network Policy 설정
- Container 보안 스캔 자동화
```

---

## 🎓 주니어 개발자를 위한 핵심 메시지

### 💪 **실무에서 가장 중요한 것**
```
1. 문제를 작은 단위로 나누어 해결하는 능력
2. 기존 패턴을 분석하고 따라하는 겸손함
3. 각 변경사항을 즉시 검증하는 신중함
4. 실패를 두려워하지 않는 도전 정신
```

### 🛠️ **기술적 성장을 위한 조언**
```
1. 로그를 읽는 능력을 기르세요 - 모든 진실은 로그에 있습니다
2. 문서화를 습관화하세요 - 미래의 당신과 동료를 위해
3. 기존 성공 사례를 먼저 분석하세요 - 바퀴를 다시 발명하지 마세요
4. 작은 변경 단위로 반복하세요 - 대규모 변경은 위험합니다
```

### 🎯 **커리어 발전을 위한 마인드셋**
```
"완벽한 첫 시도보다는 지속적인 개선"
- 실패는 학습의 기회입니다
- 문제 해결 과정 자체가 성장입니다  
- 동료와의 협업과 지식 공유가 핵심입니다
- 기술보다 문제 해결 사고방식이 더 중요합니다
```

---

**이 프로젝트는 단순한 배포를 넘어서 마이크로서비스 아키텍처에서의 사고방식과 문제 해결 방법을 배우는 소중한 경험이었습니다.**

**최종 완료 일자**: 2025-08-20  
**프로젝트 기간**: 1일 (집중 개발)  
**주요 성과**: LEE Namespace 통합 완료, 가이드라인 문서화

🤖 Generated with [Claude Code](https://claude.ai/code)