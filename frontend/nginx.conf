server {
  listen 80;

  # 프런트(지금 쓰는 것 그대로 유지)
  location /webtoon-hl {
    alias /usr/share/nginx/html;
    index index.html;
    try_files $uri $uri/ /index.html;
  }

  # (선택) 루트 접근
  location / {
    root  /usr/share/nginx/html;
    index index.html;
    try_files $uri $uri/ /index.html;
  }

  # ✅ 백엔드 프록시: /api-hl/* → webtoon-hl-backend-service:8003/*
  location ^~ /api-hl/ {
    client_max_body_size 50m;
    proxy_read_timeout 600s;

    # *** 슬래시(/)가 핵심: /api-hl/ 접두어 제거되어 /highlight 로 전달됨 ***
    proxy_pass http://webtoon-hl-backend-service:8003/;

    proxy_http_version 1.1;
    proxy_set_header Host               $host;
    proxy_set_header X-Real-IP          $remote_addr;
    proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto  $scheme;
  }
}
